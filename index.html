<!DOCTYPE html>
<html>
<head>
  <title>Qfare QR Scanner</title>
  <script src="https://unpkg.com/html5-qrcode@2.3.7/minified/html5-qrcode.min.js"></script>
</head>
<body style="text-align:center; font-family:sans-serif;">
  <h2>Scan QR Code</h2>
  <div id="reader" style="width:100%; max-width:400px; margin:auto;"></div>

  <!-- âœ… Put script AFTER html5-qrcode has loaded -->
  <script>
    // Wait until DOM and QR script are fully loaded
    document.addEventListener("DOMContentLoaded", function () {
      if (typeof Html5Qrcode === 'undefined') {
        alert("QR scanner failed to load. Please check your internet or script.");
        return;
      }

      const html5QrCode = new Html5Qrcode("reader");

      html5QrCode.start(
        { facingMode: "environment" },
        { fps: 10, qrbox: 250 },
        function onScanSuccess(decodedText) {
          if (window.ReactNativeWebView) {
            window.ReactNativeWebView.postMessage(decodedText);
          } else {
            alert("Scanned: " + decodedText); // For browser fallback
          }
        },
        function onScanError(errorMessage) {
          // console.log("Scan error:", errorMessage);
        }
      );
    });
  </script>
</body>
</html>
